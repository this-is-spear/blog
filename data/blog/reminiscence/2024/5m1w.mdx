---
title: 5월 1주 있었던 일 정리
date: '2024-05-06'
tags: ['회고', '마무리', '프로세스', '보안']
draft: false
summary: 보안 강화와 프로세스 개선
images: []
---

## 보안 강화

### 이슈

인증을 이용해 가용성을 `HTTPS`를 사용해 기밀성을 보장하지만 `SSL Strip`을 통해 도청할 수 있다.

- [중간자 공격](https://ko.wikipedia.org/wiki/%EC%A4%91%EA%B0%84%EC%9E%90_%EA%B3%B5%EA%B2%A9)
- [SSLStrip을 이용한 MITM 공격 | ADT캡스 인포섹](https://blog.naver.com/skinfosec2000/220601267742)

도청한다면 데이터 위변조가 가능해지고 `replay attack`이 가능해지는 문제가 있다.

### 해결

해당 문제를 해결하기 위해 해결책을 정리했다.

- 데이터 위변조 방지
  - 데이터 위변조를 방지하기 위해 메시지 무결성을 보장해야 했고, HMAC을 고려했다.
- `replay attack` 방지
  - `replay attack` 을 방지하기 위해 난수를 사용했고 난수도 무결성을 보장할 수 있게 구현했다.

전달 방식을 결정하면 번복하기 어려웠던터라 관련 레퍼런스를 참고했다.

- [Using the Authorization Header | AWS](https://docs.aws.amazon.com/AmazonS3/latest/API/sigv4-auth-using-authorization-header.html)
- [Implement HMAC authentication | Google](https://support.google.com/admanager/answer/7637490?hl=en)
- [HMAC authentication | Microsoft](https://learn.microsoft.com/en-us/azure/azure-app-configuration/rest-api-authentication-hmac)

작업 과정은 일주일 걸렸으며 게이트웨이에서 무결성 검증을 진행했다.

## 프로세스

> [패스트캠퍼스 강의](https://fastcampus.co.kr/dev_online_bedata) 참고

### 워크 플로우 분석

먼저 업무 흐름과 구성 요소를 분석한다.

> 이벤트 식별 -> 태스트 식별 -> 태스트 전환 식별 -> 트리거 식별

발생하는 이벤트를 정리하고 태스크를 정의하게 된다.
정의한 태스크 간 유사성을 찾아 그룹 단위로 묶게 되면 해결해야 할 도메인을 식별할 수 있다.
그렇게 도메인을 식별해 프로세스를 효율적으로 운영한다.

프로세스를 정의하기 위해서는 아래 요소를 기준으로 분석한다.

- 이벤트 : 발생 이유
- 트리거 : 이벤트를 **발생시킨 명령** 식별
- 액터 : 이벤트를 발생시킨 **주체** 파악
- 정책 : 이벤트와 관련된 **정책** 식별
- 집합 : 이벤트와 연관된 **작업** 식별 (연관성은 트랜잭션이나 생명주기로 묶는다.)

### 정리하자면

생소하거나 복잡한 워크 플로우는 위 요소를 기준으로 분석하게 되면 도메인을 원활하게 식별할 수 있다.
또한 위 요소로 다음 힌트도 얻을 수 있다.

- 이벤트를 식별해 전후 상황과 진행 과정을 빠르게 파악할 수 있다.
- 트리거로 발생 시키는 공간과 시간을 파악해 대응 시점을 파악할 수 있다.
- 액터로 제공 대상자를 파악할 수 있다.
- 정책은 이벤트가 발생하면서 수행해야 할 행위를 식별하게 한다.
- 집합으로 작업 단위를 고민해볼 수 있다.

### 마지막으로

시스템에서 도메인을 정의해봤지 업무 전반적인 도메인 흐름을 고민해본적 없다.
그래서 도메인 주소 설계는 나에게 있어서 독약이었다.
미시적인 관점에서 도메인을 분석하기 위해 작은 흐름을 세세하게 분할해가면서 복잡도만 높였다.

하지만 도메인 주도 설계는 업무 프로세스를 분할해 멀티 태스크가 가능한 구조로 만드는 일임을 깨달았다.
즉, 일부 이벤트를 자동화하기 위해 코드로 변경하며 단순 노무을 줄이는 과정이다.

도메인 주도 설계를 진행할 때 코드 기반으로 생각하는 일을 경계하고 업무 프로세스를 기준으로 효율성을 따져보도록 신경써야겠다.
